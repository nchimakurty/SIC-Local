confluent kafka topic create your-outbound-topic --partitions 6 --replication-factor 3 --config retention.ms=604800000 --config min.insync.replicas=2 --config cleanup.policy=delete --config compression.type=snappy --config max.message.bytes=1048576 --config segment.ms=86400000


# Replace values as needed:
# <topic-name>: Your topic name
# partitions: 3-6 for low volume, 10+ for high volume
# retention.ms: 604800000 = 7 days, 2592000000 = 30 days

confluent kafka topic create <topic-name> --partitions 6 --replication-factor 3 --config retention.ms=604800000 --config min.insync.replicas=2 --config cleanup.policy=delete --config compression.type=snappy --config max.message.bytes=1048576 --config segment.ms=86400000

## Configuration Breakdown

**Partitions:**
- Start with (expected throughput / target throughput per partition)
- Consider: 3-6 partitions for low volume, 10+ for high volume
- Remember: You can increase but not easily decrease

**Replication Factor:**
- **Production standard: 3** (provides fault tolerance)
- Protects against broker failures

**min.insync.replicas:**
- **Recommended: 2** (with replication factor 3)
- Ensures data is written to at least 2 replicas before acknowledging
- Critical for data durability

**Retention:**
- `retention.ms`: How long to keep messages (7 days = 604800000 ms)
- `retention.bytes`: Max size per partition (optional)

**Cleanup Policy:**
- `delete`: Remove old messages (most common)
- `compact`: Keep only latest value per key (for state topics)

**Compression:**
- `snappy` or `lz4`: Good balance of compression and CPU
- `gzip`: Better compression, more CPU intensive

**Message Size:**
- `max.message.bytes`: Default 1MB, increase if needed
- Align with producer settings

**Segment Settings:**
- `segment.ms`: 1 day (86400000) is common for production

## Before Creating - Ask These Questions:

1. **What's your expected message throughput?** (messages/second)
2. **What's your data retention requirement?** (compliance, business needs)
3. **How critical is data loss prevention?** (determines replication strategy)
4. **What's your average message size?**
5. **Do you need ordering guarantees?** (affects partition strategy)
6. **Are you using message keys?** (for compaction or ordering)

## Producer/Consumer Considerations

Your topic config should align with producer settings:
- Producer `acks=all` with `min.insync.replicas=2` for durability
- Producer `enable.idempotence=true` to prevent duplicates
- Consumer groups for parallel processing

## Monitoring After Creation

Set up alerts for:
- Under-replicated partitions
- Lag in consumer groups
- Disk usage approaching retention limits
